--Sequence for Unique TBL_SITECONTACTMAP
CREATE SEQUENCE SEQ_SIPSITECONTACTID MINVALUE 1 MAXVALUE 9999 START WITH 1 INCREMENT BY 1 NOCACHE;


--Add New Column for Unique SIP SITECONTACT ID
ALTER TABLE TBL_SITECONTACTMAP 
ADD(SIPSITECONTACTID VARCHAR2(30 CHAR));

COMMENT ON COLUMN TBL_SITECONTACTMAP.SIPSITECONTACTID IS 'SIP Unique Site Contact ID';

--Update Unique SIP ID for existing records
BEGIN

  FOR i IN (SELECT SITECONTACTID FROM TBL_SITECONTACTMAP ORDER BY SITECONTACTID) LOOP
  
      UPDATE TBL_SITECONTACTMAP
      SET SIPSITECONTACTID = 'STC' || TO_CHAR(CREATEDDT,'MMDDYYYYHH24MISS') || LPAD(SEQ_SIPSITECONTACTID.NEXTVAL,4,0) 
      WHERE SITECONTACTID = i.SITECONTACTID;              
  
      COMMIT;
  
  END LOOP;
  
END;
/

--Make SIP SITECONTACT ID as NOT NULL
ALTER TABLE TBL_SITECONTACTMAP
MODIFY(SIPSITECONTACTID VARCHAR2(30 CHAR) NOT NULL);	